<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://public-frontend-cos.metadl.com/mgx/img/favicon.png" type="image/png">
    <title>FoodOrder - Pesan Makanan Online</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B35',
                        secondary: '#F7931E',
                        accent: '#FFD23F',
                        dark: '#2D3748',
                        light: '#F7FAFC'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .modal-backdrop {
            backdrop-filter: blur(8px);
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FFD23F 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .animate-pulse-slow {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #FF6B35;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>

<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="gradient-bg shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="bg-white p-2 rounded-full shadow-md">
                        <i class="fas fa-utensils text-primary text-xl"></i>
                    </div>
                    <h1 class="text-2xl font-bold text-white">FoodOrder</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="locationBtn" class="glass-effect text-white px-4 py-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all duration-300">
                        <i class="fas fa-map-marker-alt mr-2"></i>
                        <span id="locationText">Deteksi Lokasi</span>
                    </button>
                    <div class="bg-white bg-opacity-20 text-white px-4 py-2 rounded-full">
                        <i class="fas fa-shopping-cart mr-2"></i>
                        <span id="cartCount">0</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="gradient-bg py-16">
        <div class="container mx-auto px-4 text-center">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-5xl font-bold text-white mb-6 animate-float">
                    Pesan Makanan Favorit Anda
                </h2>
                <p class="text-xl text-white text-opacity-90 mb-8">
                    Nikmati berbagai pilihan makanan lezat dengan layanan antar yang cepat dan terpercaya
                </p>
                <div class="flex flex-wrap justify-center gap-4">
                    <div class="glass-effect text-white px-6 py-3 rounded-full">
                        <i class="fas fa-clock mr-2"></i>
                        Pengiriman 30 Menit
                    </div>
                    <div class="glass-effect text-white px-6 py-3 rounded-full">
                        <i class="fas fa-shield-alt mr-2"></i>
                        Pembayaran COD
                    </div>
                    <div class="glass-effect text-white px-6 py-3 rounded-full">
                        <i class="fas fa-star mr-2"></i>
                        Rating 4.8/5
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="py-16">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h3 class="text-4xl font-bold text-dark mb-4">Menu Pilihan</h3>
                <p class="text-gray-600 text-lg">Pilih dari berbagai makanan lezat yang tersedia</p>
            </div>
            
            <!-- Category Filter -->
            <div class="flex flex-wrap justify-center gap-4 mb-12">
                <button class="category-btn active bg-primary text-white px-6 py-3 rounded-full font-medium hover:bg-opacity-90 transition-all duration-300" data-category="all">
                    Semua Menu
                </button>
                <button class="category-btn bg-white text-dark px-6 py-3 rounded-full font-medium border-2 border-gray-200 hover:border-primary hover:text-primary transition-all duration-300" data-category="makanan-utama">
                    Makanan Utama
                </button>
                <button class="category-btn bg-white text-dark px-6 py-3 rounded-full font-medium border-2 border-gray-200 hover:border-primary hover:text-primary transition-all duration-300" data-category="minuman">
                    Minuman
                </button>
                <button class="category-btn bg-white text-dark px-6 py-3 rounded-full font-medium border-2 border-gray-200 hover:border-primary hover:text-primary transition-all duration-300" data-category="dessert">
                    Dessert
                </button>
            </div>

            <!-- Products Grid -->
            <div id="productsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- Products will be dynamically loaded here -->
            </div>
        </div>
    </section>

    <!-- Product Detail Modal -->
    <div id="productModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop fixed inset-0" onclick="closeProductModal()"></div>
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-screen overflow-y-auto transform transition-all duration-300 scale-95 opacity-0" id="productModalContent">
                <div class="relative">
                    <button onclick="closeProductModal()" class="absolute top-4 right-4 z-10 bg-white bg-opacity-80 hover:bg-opacity-100 text-gray-600 hover:text-gray-800 w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                    <div id="productModalBody">
                        <!-- Product details will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop fixed inset-0" onclick="closeCheckoutModal()"></div>
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full max-h-screen overflow-y-auto transform transition-all duration-300 scale-95 opacity-0" id="checkoutModalContent">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-bold text-dark">Checkout Pesanan</h3>
                        <button onclick="closeCheckoutModal()" class="text-gray-400 hover:text-gray-600 transition-colors duration-300">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <form id="checkoutForm" class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                            <input type="text" id="customerName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-300" placeholder="Masukkan nama lengkap">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nomor Telepon</label>
                            <input type="tel" id="customerPhone" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-300" placeholder="Masukkan nomor telepon">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Alamat Pengiriman</label>
                            <textarea id="customerAddress" required rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-300 resize-none" placeholder="Masukkan alamat lengkap"></textarea>
                        </div>
                        
                        <div id="locationInfo" class="hidden bg-blue-50 p-4 rounded-lg">
                            <div class="flex items-center text-blue-700">
                                <i class="fas fa-map-marker-alt mr-2"></i>
                                <span class="font-medium">Lokasi Terdeteksi:</span>
                            </div>
                            <p id="detectedLocation" class="text-blue-600 text-sm mt-1"></p>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Jumlah</label>
                            <div class="flex items-center space-x-4">
                                <button type="button" onclick="decreaseQuantity()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span id="quantity" class="text-xl font-semibold text-dark min-w-[2rem] text-center">1</span>
                                <button type="button" onclick="increaseQuantity()" class="bg-primary hover:bg-opacity-90 text-white w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="border-t pt-4">
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-lg font-medium text-gray-700">Total Pembayaran:</span>
                                <span id="totalPrice" class="text-2xl font-bold text-primary">Rp 0</span>
                            </div>
                        </div>
                        
                        <button type="submit" class="w-full gradient-bg text-white py-4 rounded-lg font-semibold text-lg hover:shadow-lg transform hover:scale-105 transition-all duration-300 flex items-center justify-center">
                            <span id="submitBtnText">Selesaikan Pesanan</span>
                            <div id="submitLoader" class="loading-spinner ml-3 hidden"></div>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- COD Confirmation Modal -->
    <div id="codModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop fixed inset-0"></div>
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-95 opacity-0" id="codModalContent">
                <div class="p-8 text-center">
                    <div class="mb-6">
                        <div class="bg-green-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-check text-green-500 text-3xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-dark mb-2">Pesanan Berhasil!</h3>
                        <p class="text-gray-600">Pesanan Anda telah diterima dan akan segera diproses</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 mb-6 text-left">
                        <h4 class="font-semibold text-dark mb-3">Detail Pesanan:</h4>
                        <div id="orderSummary" class="space-y-2 text-sm text-gray-600">
                            <!-- Order details will be populated here -->
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 rounded-lg p-4 mb-6">
                        <div class="flex items-center text-blue-700 mb-2">
                            <i class="fas fa-money-bill-wave mr-2"></i>
                            <span class="font-semibold">Pembayaran COD</span>
                        </div>
                        <p class="text-blue-600 text-sm">Bayar langsung kepada kurir saat makanan tiba</p>
                    </div>
                    
                    <button onclick="closeCodModal()" class="w-full gradient-bg text-white py-3 rounded-lg font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300">
                        Tutup
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="bg-primary p-2 rounded-full">
                            <i class="fas fa-utensils text-white"></i>
                        </div>
                        <h4 class="text-xl font-bold">FoodOrder</h4>
                    </div>
                    <p class="text-gray-400">Platform pemesanan makanan online terpercaya dengan layanan terbaik untuk Anda.</p>
                </div>
                <div>
                    <h5 class="font-semibold mb-4">Kontak</h5>
                    <div class="space-y-2 text-gray-400">
                        <p><i class="fas fa-phone mr-2"></i> +62 812-3456-7890</p>
                        <p><i class="fas fa-envelope mr-2"></i> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="462f282029062029292229342223346825292b">[email&#160;protected]</a></p>
                        <p><i class="fas fa-map-marker-alt mr-2"></i> Jakarta, Indonesia</p>
                    </div>
                </div>
                <div>
                    <h5 class="font-semibold mb-4">Ikuti Kami</h5>
                    <div class="flex space-x-4">
                        <a href="#" class="bg-gray-700 hover:bg-primary w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="bg-gray-700 hover:bg-primary w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="bg-gray-700 hover:bg-primary w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2024 FoodOrder. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        // Mock Database - Products
        const products = [
            {
                id: 1,
                name: "Nasi Gudeg Jogja",
                price: 25000,
                category: "makanan-utama",
                image: "https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=400&h=300&fit=crop",
                description: "Gudeg khas Jogja dengan ayam kampung, telur, dan krecek. Disajikan dengan nasi hangat dan sambal krecek yang pedas.",
                rating: 4.8,
                cookTime: "20-25 menit"
            },
            {
                id: 2,
                name: "Ayam Bakar Taliwang",
                price: 35000,
                category: "makanan-utama",
                image: "https://images.unsplash.com/photo-1598103442097-8b74394b95c6?w=400&h=300&fit=crop",
                description: "Ayam bakar khas Lombok dengan bumbu taliwang yang pedas dan gurih. Disajikan dengan plecing kangkung.",
                rating: 4.9,
                cookTime: "25-30 menit"
            },
            {
                id: 3,
                name: "Es Teh Manis",
                price: 8000,
                category: "minuman",
                image: "https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400&h=300&fit=crop",
                description: "Es teh manis segar dengan gula aren asli. Minuman tradisional yang menyegarkan.",
                rating: 4.5,
                cookTime: "5 menit"
            },
            {
                id: 4,
                name: "Sate Ayam Madura",
                price: 30000,
                category: "makanan-utama",
                image: "https://images.unsplash.com/photo-1529563021893-cc83c992d75d?w=400&h=300&fit=crop",
                description: "Sate ayam khas Madura dengan bumbu kacang yang kental dan gurih. 10 tusuk sate dengan lontong.",
                rating: 4.7,
                cookTime: "15-20 menit"
            },
            {
                id: 5,
                name: "Es Cendol",
                price: 12000,
                category: "dessert",
                image: "https://images.unsplash.com/photo-1563379091339-03246963d4d6?w=400&h=300&fit=crop",
                description: "Es cendol dengan santan kental, gula merah, dan cendol hijau. Dessert tradisional yang menyegarkan.",
                rating: 4.6,
                cookTime: "5-10 menit"
            },
            {
                id: 6,
                name: "Jus Alpukat",
                price: 15000,
                category: "minuman",
                image: "https://images.unsplash.com/photo-1623065422902-30a2d299bbe4?w=400&h=300&fit=crop",
                description: "Jus alpukat segar dengan susu kental manis dan es batu. Kaya nutrisi dan menyegarkan.",
                rating: 4.4,
                cookTime: "5 menit"
            },
            {
                id: 7,
                name: "Rendang Daging",
                price: 45000,
                category: "makanan-utama",
                image: "https://images.unsplash.com/photo-1604908176997-125f25cc6f3d?w=400&h=300&fit=crop",
                description: "Rendang daging sapi khas Padang dengan bumbu rempah yang kaya. Dimasak hingga empuk dan bumbu meresap.",
                rating: 4.9,
                cookTime: "30-35 menit"
            },
            {
                id: 8,
                name: "Klepon",
                price: 18000,
                category: "dessert",
                image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",
                description: "Klepon tradisional dengan isian gula merah dan taburan kelapa parut. 8 buah klepon dalam satu porsi.",
                rating: 4.3,
                cookTime: "10-15 menit"
            }
        ];

        // Global variables
        let currentProduct = null;
        let currentQuantity = 1;
        let userLocation = null;
        let cartCount = 0;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            setupEventListeners();
            detectLocation();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Category filter buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Update active button
                    document.querySelectorAll('.category-btn').forEach(b => {
                        b.classList.remove('active', 'bg-primary', 'text-white');
                        b.classList.add('bg-white', 'text-dark', 'border-2', 'border-gray-200');
                    });
                    this.classList.add('active', 'bg-primary', 'text-white');
                    this.classList.remove('bg-white', 'text-dark', 'border-2', 'border-gray-200');
                    
                    // Filter products
                    const category = this.dataset.category;
                    loadProducts(category);
                });
            });

            // Checkout form
            document.getElementById('checkoutForm').addEventListener('submit', handleCheckout);

            // Location button
            document.getElementById('locationBtn').addEventListener('click', detectLocation);
        }

        // Load and display products
        function loadProducts(category = 'all') {
            const grid = document.getElementById('productsGrid');
            const filteredProducts = category === 'all' ? products : products.filter(p => p.category === category);
            
            grid.innerHTML = filteredProducts.map(product => `
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover cursor-pointer transform transition-all duration-300" onclick="openProductModal(${product.id})">
                    <div class="relative overflow-hidden">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover transition-transform duration-300 hover:scale-110">
                        <div class="absolute top-4 right-4 bg-white bg-opacity-90 px-2 py-1 rounded-full text-sm font-medium text-dark">
                            <i class="fas fa-star text-yellow-400 mr-1"></i>
                            ${product.rating}
                        </div>
                        <div class="absolute bottom-4 left-4 bg-primary text-white px-3 py-1 rounded-full text-sm font-medium">
                            <i class="fas fa-clock mr-1"></i>
                            ${product.cookTime}
                        </div>
                    </div>
                    <div class="p-6">
                        <h4 class="text-xl font-semibold text-dark mb-2">${product.name}</h4>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-2">${product.description}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-2xl font-bold text-primary">Rp ${product.price.toLocaleString('id-ID')}</span>
                            <button class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-full font-medium transition-all duration-300 transform hover:scale-105">
                                <i class="fas fa-plus mr-2"></i>
                                Pesan
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Open product modal
        function openProductModal(productId) {
            currentProduct = products.find(p => p.id === productId);
            if (!currentProduct) return;

            const modal = document.getElementById('productModal');
            const modalContent = document.getElementById('productModalContent');
            const modalBody = document.getElementById('productModalBody');

            modalBody.innerHTML = `
                <div class="relative">
                    <img src="${currentProduct.image}" alt="${currentProduct.name}" class="w-full h-64 md:h-80 object-cover">
                    <div class="absolute bottom-4 left-4 bg-white bg-opacity-90 px-3 py-2 rounded-full">
                        <div class="flex items-center text-sm font-medium text-dark">
                            <i class="fas fa-star text-yellow-400 mr-1"></i>
                            ${currentProduct.rating}
                            <span class="mx-2">â€¢</span>
                            <i class="fas fa-clock mr-1"></i>
                            ${currentProduct.cookTime}
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <h3 class="text-3xl font-bold text-dark mb-4">${currentProduct.name}</h3>
                    <p class="text-gray-600 text-lg mb-6 leading-relaxed">${currentProduct.description}</p>
                    <div class="flex items-center justify-between mb-6">
                        <span class="text-3xl font-bold text-primary">Rp ${currentProduct.price.toLocaleString('id-ID')}</span>
                        <div class="bg-gray-100 px-4 py-2 rounded-full">
                            <span class="text-sm font-medium text-gray-600">Kategori: ${getCategoryName(currentProduct.category)}</span>
                        </div>
                    </div>
                    <button onclick="openCheckoutModal()" class="w-full gradient-bg text-white py-4 rounded-lg font-semibold text-lg hover:shadow-lg transform hover:scale-105 transition-all duration-300">
                        <i class="fas fa-shopping-cart mr-2"></i>
                        Beli Sekarang
                    </button>
                </div>
            `;

            modal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        // Close product modal
        function closeProductModal() {
            const modal = document.getElementById('productModal');
            const modalContent = document.getElementById('productModalContent');
            
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        // Open checkout modal
        function openCheckoutModal() {
            closeProductModal();
            
            const modal = document.getElementById('checkoutModal');
            const modalContent = document.getElementById('checkoutModalContent');
            
            // Reset form
            currentQuantity = 1;
            document.getElementById('quantity').textContent = currentQuantity;
            updateTotalPrice();
            
            // Fill location if available
            if (userLocation) {
                document.getElementById('locationInfo').classList.remove('hidden');
                document.getElementById('detectedLocation').textContent = userLocation;
            }

            modal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        // Close checkout modal
        function closeCheckoutModal() {
            const modal = document.getElementById('checkoutModal');
            const modalContent = document.getElementById('checkoutModalContent');
            
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        // Quantity controls
        function increaseQuantity() {
            currentQuantity++;
            document.getElementById('quantity').textContent = currentQuantity;
            updateTotalPrice();
        }

        function decreaseQuantity() {
            if (currentQuantity > 1) {
                currentQuantity--;
                document.getElementById('quantity').textContent = currentQuantity;
                updateTotalPrice();
            }
        }

        // Update total price
        function updateTotalPrice() {
            if (currentProduct) {
                const total = currentProduct.price * currentQuantity;
                document.getElementById('totalPrice').textContent = `Rp ${total.toLocaleString('id-ID')}`;
            }
        }

        // Handle checkout form submission
        async function handleCheckout(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtnText');
            const loader = document.getElementById('submitLoader');
            
            // Show loading
            submitBtn.textContent = 'Memproses...';
            loader.classList.remove('hidden');
            
            // Get form data
            const formData = {
                customerName: document.getElementById('customerName').value,
                customerPhone: document.getElementById('customerPhone').value,
                customerAddress: document.getElementById('customerAddress').value,
                product: currentProduct,
                quantity: currentQuantity,
                totalPrice: currentProduct.price * currentQuantity,
                location: userLocation,
                orderDate: new Date().toISOString(),
                status: 'pending',
                paymentMethod: 'COD'
            };

            try {
                // Simulate API call to Supabase
                await simulateOrderSubmission(formData);
                
                // Update cart count
                cartCount++;
                document.getElementById('cartCount').textContent = cartCount;
                
                // Close checkout modal and show COD modal
                closeCheckoutModal();
                setTimeout(() => {
                    showCodModal(formData);
                }, 300);
                
            } catch (error) {
                console.error('Error submitting order:', error);
                alert('Terjadi kesalahan saat memproses pesanan. Silakan coba lagi.');
            } finally {
                // Reset button
                submitBtn.textContent = 'Selesaikan Pesanan';
                loader.classList.add('hidden');
            }
        }

        // Simulate order submission to Supabase
        async function simulateOrderSubmission(orderData) {
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Store in localStorage for demo purposes
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push({
                ...orderData,
                id: Date.now(),
                orderNumber: `FO${Date.now().toString().slice(-6)}`
            });
            localStorage.setItem('orders', JSON.stringify(orders));
            
            console.log('Order submitted to database:', orderData);
        }

        // Show COD confirmation modal
        function showCodModal(orderData) {
            const modal = document.getElementById('codModal');
            const modalContent = document.getElementById('codModalContent');
            const orderSummary = document.getElementById('orderSummary');
            
            orderSummary.innerHTML = `
                <div class="flex justify-between">
                    <span>Produk:</span>
                    <span class="font-medium">${orderData.product.name}</span>
                </div>
                <div class="flex justify-between">
                    <span>Jumlah:</span>
                    <span class="font-medium">${orderData.quantity}x</span>
                </div>
                <div class="flex justify-between">
                    <span>Nama:</span>
                    <span class="font-medium">${orderData.customerName}</span>
                </div>
                <div class="flex justify-between">
                    <span>Telepon:</span>
                    <span class="font-medium">${orderData.customerPhone}</span>
                </div>
                <div class="flex justify-between font-semibold text-primary">
                    <span>Total:</span>
                    <span>Rp ${orderData.totalPrice.toLocaleString('id-ID')}</span>
                </div>
            `;

            modal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        // Close COD modal
        function closeCodModal() {
            const modal = document.getElementById('codModal');
            const modalContent = document.getElementById('codModalContent');
            
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                // Reset checkout form
                document.getElementById('checkoutForm').reset();
            }, 300);
        }

        // Detect user location
        function detectLocation() {
            const locationBtn = document.getElementById('locationBtn');
            const locationText = document.getElementById('locationText');
            
            locationText.textContent = 'Mendeteksi...';
            locationBtn.disabled = true;
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const { latitude, longitude } = position.coords;
                        
                        try {
                            // Use reverse geocoding to get address
                            const response = await fetch(`https://api.opencagedata.com/geocode/v1/json?q=${latitude}+${longitude}&key=YOUR_API_KEY`);
                            const data = await response.json();
                            
                            if (data.results && data.results.length > 0) {
                                userLocation = data.results[0].formatted;
                            } else {
                                userLocation = `${latitude.toFixed(4)}, ${longitude.toFixed(4)}`;
                            }
                        } catch (error) {
                            // Fallback to coordinates if geocoding fails
                            userLocation = `${latitude.toFixed(4)}, ${longitude.toFixed(4)}`;
                        }
                        
                        locationText.textContent = 'Lokasi Terdeteksi';
                        locationBtn.disabled = false;
                        
                        // Show success message
                        showLocationSuccess();
                    },
                    (error) => {
                        console.error('Geolocation error:', error);
                        locationText.textContent = 'Gagal Deteksi';
                        locationBtn.disabled = false;
                        
                        // Show error message
                        alert('Tidak dapat mendeteksi lokasi. Pastikan Anda mengizinkan akses lokasi.');
                    }
                );
            } else {
                locationText.textContent = 'Tidak Didukung';
                locationBtn.disabled = false;
                alert('Browser Anda tidak mendukung deteksi lokasi.');
            }
        }

        // Show location success notification
        function showLocationSuccess() {
            const notification = document.createElement('div');
            notification.className = 'fixed top-20 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-check-circle mr-2"></i>
                    <span>Lokasi berhasil terdeteksi!</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Get category display name
        function getCategoryName(category) {
            const categoryNames = {
                'makanan-utama': 'Makanan Utama',
                'minuman': 'Minuman',
                'dessert': 'Dessert'
            };
            return categoryNames[category] || category;
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-backdrop')) {
                if (!document.getElementById('productModal').classList.contains('hidden')) {
                    closeProductModal();
                }
                if (!document.getElementById('checkoutModal').classList.contains('hidden')) {
                    closeCheckoutModal();
                }
            }
        });

        // Close modals with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (!document.getElementById('productModal').classList.contains('hidden')) {
                    closeProductModal();
                }
                if (!document.getElementById('checkoutModal').classList.contains('hidden')) {
                    closeCheckoutModal();
                }
                if (!document.getElementById('codModal').classList.contains('hidden')) {
                    closeCodModal();
                }
            }
        });
    </script>
</body>

</html>
